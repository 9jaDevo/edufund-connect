(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[83],{8879:function(e,r,t){Promise.resolve().then(t.bind(t,6434))},6434:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return Z}});var a=t(7437),s=t(6463),i=t(2265),n=t(1066);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,n.Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var c=t(7138),o=t(9343),d=t(1014);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let m=(0,n.Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),u=(0,n.Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),p=(0,n.Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var x=t(537);let h=x.Ry({title:x.Z_().min(10,"Title must be at least 10 characters"),description:x.Z_().min(50,"Description must be at least 50 characters"),project_type:x.Z_().min(1,"Please select a project type"),location:x.Z_().min(3,"Location is required"),location_lat:x.Rx().optional(),location_long:x.Rx().optional(),budget:x.Rx().min(1,"Budget must be greater than 0"),beneficiaries_count:x.Rx().min(1,"Number of beneficiaries must be at least 1"),start_date:x.Z_().optional(),end_date:x.Z_().optional(),image_url:x.Z_().url().optional()});x.Ry({title:x.Z_().min(5,"Title must be at least 5 characters"),description:x.Z_().optional(),amount:x.Rx().min(0,"Amount must be 0 or greater"),order:x.Rx().min(1),target_date:x.Z_().optional()});var f=t(9733),g=t(7209),b=t(8185),j=t(6804);let y=(0,i.forwardRef)((e,r)=>{let{className:t,variant:s="default",...i}=e;return(0,a.jsx)("span",{ref:r,className:(0,j.cn)("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium",{default:"bg-gray-100 text-gray-800",primary:"bg-primary-100 text-primary-800",secondary:"bg-secondary-100 text-secondary-800",accent:"bg-accent-100 text-accent-800",success:"bg-success-100 text-success-800",warning:"bg-warning-100 text-warning-800",error:"bg-error-100 text-error-800",outline:"border border-gray-300 text-gray-700"}[s],t),...i})});y.displayName="Badge";let v=[{value:"student_sponsorship",label:"Student Sponsorship"},{value:"infrastructure",label:"Infrastructure (Borehole, Classroom, etc.)"},{value:"education_materials",label:"Education Materials"},{value:"teacher_training",label:"Teacher Training"},{value:"technology",label:"Technology & Equipment"},{value:"other",label:"Other Community Project"}];function N(e){var r,t,s,n,c,x,j;let{onSubmit:N,isLoading:_}=e,[w,Z]=(0,i.useState)(1),{register:P,handleSubmit:R,formState:{errors:S},watch:k,trigger:C}=(0,o.cI)({resolver:(0,d.F)(h),mode:"onChange"}),B=async()=>{let e=[];1===w?e=["title","project_type","description"]:2===w&&(e=["location","budget","beneficiaries_count"]),await C(e)&&w<3&&Z(w+1)},I=async e=>{await N(e)};return(0,a.jsxs)(b.Zb,{className:"max-w-3xl mx-auto",children:[(0,a.jsxs)(b.Ol,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)(b.ll,{children:"Create New Project"}),(0,a.jsx)("div",{className:"flex gap-2",children:Array.from({length:3}).map((e,r)=>(0,a.jsx)("div",{className:"h-2 w-12 rounded-full ".concat(r+1<=w?"bg-primary-500":"bg-gray-200")},r))})]}),(0,a.jsxs)(b.SZ,{children:["Step ",w," of ",3]})]}),(0,a.jsx)(b.aY,{children:(0,a.jsxs)("form",{onSubmit:R(I),className:"space-y-6",children:[1===w&&(0,a.jsxs)("div",{className:"space-y-4 animate-fade-in",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"title",className:"form-label",children:"Project Title"}),(0,a.jsx)(g.I,{id:"title",placeholder:"e.g., Computer Lab for Greenwood School",error:null===(r=S.title)||void 0===r?void 0:r.message,...P("title")}),(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Make it descriptive and compelling"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"project_type",className:"form-label",children:"Project Type"}),(0,a.jsxs)("select",{id:"project_type",className:"form-input",...P("project_type"),children:[(0,a.jsx)("option",{value:"",children:"Select a project type"}),v.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))]}),S.project_type&&(0,a.jsx)("p",{className:"form-error",children:S.project_type.message})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"description",className:"form-label",children:"Project Description"}),(0,a.jsx)("textarea",{id:"description",rows:6,className:"form-input",placeholder:"Describe your project in detail. What will be done? Who will benefit? What impact will it have?",...P("description")}),S.description&&(0,a.jsx)("p",{className:"form-error",children:S.description.message}),(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Minimum 50 characters. Be specific about goals and outcomes."})]})]}),2===w&&(0,a.jsxs)("div",{className:"space-y-4 animate-fade-in",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"location",className:"form-label",children:"Project Location"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(m,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,a.jsx)("input",{id:"location",type:"text",className:"form-input pl-10",placeholder:"e.g., Nairobi, Kenya",...P("location")})]}),S.location&&(0,a.jsx)("p",{className:"form-error",children:S.location.message})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"budget",className:"form-label",children:"Total Budget (USD)"}),(0,a.jsx)(g.I,{id:"budget",type:"number",step:"0.01",placeholder:"10000",error:null===(t=S.budget)||void 0===t?void 0:t.message,...P("budget",{valueAsNumber:!0})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"beneficiaries_count",className:"form-label",children:"Number of Beneficiaries"}),(0,a.jsx)(g.I,{id:"beneficiaries_count",type:"number",placeholder:"50",error:null===(s=S.beneficiaries_count)||void 0===s?void 0:s.message,...P("beneficiaries_count",{valueAsNumber:!0})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"start_date",className:"form-label",children:"Expected Start Date (Optional)"}),(0,a.jsx)(g.I,{id:"start_date",type:"date",error:null===(n=S.start_date)||void 0===n?void 0:n.message,...P("start_date")})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"end_date",className:"form-label",children:"Expected End Date (Optional)"}),(0,a.jsx)(g.I,{id:"end_date",type:"date",error:null===(c=S.end_date)||void 0===c?void 0:c.message,...P("end_date")})]})]})]}),3===w&&(0,a.jsxs)("div",{className:"space-y-4 animate-fade-in",children:[(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 space-y-4",children:[(0,a.jsx)("h3",{className:"font-semibold text-lg",children:"Review Your Project"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Title"}),(0,a.jsx)("p",{className:"font-medium",children:k("title")})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Type"}),(0,a.jsx)(y,{variant:"primary",children:null===(x=v.find(e=>e.value===k("project_type")))||void 0===x?void 0:x.label})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Description"}),(0,a.jsx)("p",{className:"text-sm",children:k("description")})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Location"}),(0,a.jsx)("p",{className:"font-medium",children:k("location")})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Budget"}),(0,a.jsxs)("p",{className:"font-medium",children:["$",null===(j=k("budget"))||void 0===j?void 0:j.toLocaleString()]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Beneficiaries"}),(0,a.jsx)("p",{className:"font-medium",children:k("beneficiaries_count")})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Duration"}),(0,a.jsx)("p",{className:"font-medium",children:k("start_date")&&k("end_date")?"".concat(k("start_date")," to ").concat(k("end_date")):"Not specified"})]})]})]}),(0,a.jsx)("div",{className:"bg-warning-50 border border-warning-200 rounded-lg p-4",children:(0,a.jsxs)("p",{className:"text-sm text-warning-800",children:[(0,a.jsx)("strong",{children:"Note:"})," Your project will be reviewed by our admin team before going live. You'll receive an email notification once it's approved."]})})]}),(0,a.jsxs)("div",{className:"flex justify-between pt-4 border-t",children:[(0,a.jsx)(f.z,{type:"button",variant:"outline",onClick:()=>{w>1&&Z(w-1)},disabled:1===w,leftIcon:(0,a.jsx)(l,{className:"h-4 w-4"}),children:"Back"}),w<3?(0,a.jsx)(f.z,{type:"button",variant:"primary",onClick:B,rightIcon:(0,a.jsx)(u,{className:"h-4 w-4"}),children:"Next Step"}):(0,a.jsx)(f.z,{type:"submit",variant:"success",isLoading:_,leftIcon:(0,a.jsx)(p,{className:"h-4 w-4"}),children:"Submit Project"})]})]})})]})}var _=t(2157),w=t(8726);function Z(){let e=(0,s.useRouter)(),[r,t]=(0,i.useState)(!1),n=(0,_.e)(),o=async r=>{t(!0);try{let{data:{user:t}}=await n.auth.getUser();if(!t){w.ZP.error("You must be logged in to create a project");return}let{data:a,error:s}=await n.from("ngos").select("id").eq("user_id",t.id).single();if(s||!a){w.ZP.error("NGO profile not found. Please complete your profile first.");return}let{data:i,error:l}=await n.from("projects").insert({ngo_id:a.id,title:r.title,description:r.description,project_type:r.project_type,location:r.location,budget:r.budget,beneficiaries_count:r.beneficiaries_count,start_date:r.start_date||null,end_date:r.end_date||null,status:"pending",amount_raised:0}).select().single();if(l){console.error("Project creation error:",l),w.ZP.error("Failed to create project: "+l.message);return}w.ZP.success("Project created successfully! It will be reviewed by our admin team."),e.push("/ngo/projects")}catch(e){console.error("Unexpected error:",e),w.ZP.error("An unexpected error occurred")}finally{t(!1)}};return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"mb-8",children:(0,a.jsx)(c.default,{href:"/ngo",children:(0,a.jsx)(f.z,{variant:"ghost",size:"sm",leftIcon:(0,a.jsx)(l,{className:"h-4 w-4"}),children:"Back to Dashboard"})})}),(0,a.jsx)(N,{onSubmit:o,isLoading:r})]})}},9733:function(e,r,t){"use strict";t.d(r,{z:function(){return l}});var a=t(7437),s=t(2265),i=t(6804),n=t(4109);let l=(0,s.forwardRef)((e,r)=>{let{className:t,variant:s="primary",size:l="md",isLoading:c,leftIcon:o,rightIcon:d,fullWidth:m,children:u,disabled:p,...x}=e;return(0,a.jsxs)("button",{ref:r,className:(0,i.cn)("inline-flex items-center justify-center rounded-lg font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none",{primary:"bg-primary-500 text-white hover:bg-primary-600 focus:ring-primary-500",secondary:"bg-secondary-500 text-white hover:bg-secondary-600 focus:ring-secondary-500",outline:"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:ring-primary-500",ghost:"text-gray-700 hover:bg-gray-100 focus:ring-primary-500",error:"bg-error-500 text-white hover:bg-error-600 focus:ring-error-500",success:"bg-success-500 text-white hover:bg-success-600 focus:ring-success-500",warning:"bg-warning-500 text-white hover:bg-warning-600 focus:ring-warning-500"}[s],{sm:"text-sm px-3 py-1.5 gap-1.5",md:"text-base px-4 py-2 gap-2",lg:"text-lg px-6 py-3 gap-2"}[l],m&&"w-full",t),disabled:p||c,...x,children:[c?(0,a.jsx)(n.Z,{className:"h-4 w-4 animate-spin"}):o&&(0,a.jsx)("span",{className:"flex-shrink-0",children:o}),u,d&&!c&&(0,a.jsx)("span",{className:"flex-shrink-0",children:d})]})});l.displayName="Button"},8185:function(e,r,t){"use strict";t.d(r,{Ol:function(){return l},SZ:function(){return o},Zb:function(){return n},aY:function(){return d},ll:function(){return c}});var a=t(7437),s=t(2265),i=t(6804);let n=(0,s.forwardRef)((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,i.cn)("rounded-lg border border-gray-200 bg-white shadow-card",t),...s})});n.displayName="Card";let l=(0,s.forwardRef)((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",t),...s})});l.displayName="CardHeader";let c=(0,s.forwardRef)((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("h3",{ref:r,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",t),...s})});c.displayName="CardTitle";let o=(0,s.forwardRef)((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("p",{ref:r,className:(0,i.cn)("text-sm text-gray-500",t),...s})});o.displayName="CardDescription";let d=(0,s.forwardRef)((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,i.cn)("p-6 pt-0",t),...s})});d.displayName="CardContent",(0,s.forwardRef)((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,i.cn)("flex items-center p-6 pt-0",t),...s})}).displayName="CardFooter"},7209:function(e,r,t){"use strict";t.d(r,{I:function(){return n}});var a=t(7437),s=t(2265),i=t(6804);let n=(0,s.forwardRef)((e,r)=>{let{className:t,type:s,error:n,...l}=e;return(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("input",{type:s,className:(0,i.cn)("flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent disabled:cursor-not-allowed disabled:opacity-50",n&&"border-error-500 focus:ring-error-500",t),ref:r,...l}),n&&(0,a.jsx)("p",{className:"mt-1 text-sm text-error-500",children:n})]})});n.displayName="Input"},2157:function(e,r,t){"use strict";t.d(r,{e:function(){return i}});var a=t(3686),s=t(357);function i(){return(0,a.createBrowserClient)(s.env.NEXT_PUBLIC_SUPABASE_URL,s.env.NEXT_PUBLIC_SUPABASE_ANON_KEY)}},6804:function(e,r,t){"use strict";t.d(r,{cn:function(){return i}});var a=t(4839),s=t(6164);function i(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,s.m6)((0,a.W)(r))}}},function(e){e.O(0,[231,726,549,13,971,23,744],function(){return e(e.s=8879)}),_N_E=e.O()}]);